exports.id=942,exports.ids=[942],exports.modules={8359:()=>{},3739:()=>{},2897:(e,t,a)=>{let r={"335416c852e4351f6b071da0c449797609cd3529":()=>Promise.resolve().then(a.bind(a,4581)).then(e=>e.getAnalytics),"35c11c197751039da8f79a890078abb74d092a65":()=>Promise.resolve().then(a.bind(a,4581)).then(e=>e.fetchAllUsers),"6727771b2df0b010539eaed6952ef9332cfce98a":()=>Promise.resolve().then(a.bind(a,4581)).then(e=>e.checkLimitAndGenerate),"835ec64ccae7930043818c24f422beb902ac9d78":()=>Promise.resolve().then(a.bind(a,4581)).then(e=>e.toggleUserBan),"91099f875fa14361579487b40c54bb06a8dc24eb":()=>Promise.resolve().then(a.bind(a,4581)).then(e=>e.updateUserLimit),a83cafce4865bcea7adfb375bae692f6cb61af35:()=>Promise.resolve().then(a.bind(a,4581)).then(e=>e.loginUser),defd6a130648ded6c12e094a7abfe2a206ba3421:()=>Promise.resolve().then(a.bind(a,4581)).then(e=>e.adminLogin)};async function s(e,...t){return(await r[e]()).apply(null,t)}e.exports={"335416c852e4351f6b071da0c449797609cd3529":s.bind(null,"335416c852e4351f6b071da0c449797609cd3529"),"35c11c197751039da8f79a890078abb74d092a65":s.bind(null,"35c11c197751039da8f79a890078abb74d092a65"),"6727771b2df0b010539eaed6952ef9332cfce98a":s.bind(null,"6727771b2df0b010539eaed6952ef9332cfce98a"),"835ec64ccae7930043818c24f422beb902ac9d78":s.bind(null,"835ec64ccae7930043818c24f422beb902ac9d78"),"91099f875fa14361579487b40c54bb06a8dc24eb":s.bind(null,"91099f875fa14361579487b40c54bb06a8dc24eb"),a83cafce4865bcea7adfb375bae692f6cb61af35:s.bind(null,"a83cafce4865bcea7adfb375bae692f6cb61af35"),defd6a130648ded6c12e094a7abfe2a206ba3421:s.bind(null,"defd6a130648ded6c12e094a7abfe2a206ba3421")}},3124:(e,t,a)=>{Promise.resolve().then(a.t.bind(a,2583,23)),Promise.resolve().then(a.t.bind(a,6840,23)),Promise.resolve().then(a.t.bind(a,8771,23)),Promise.resolve().then(a.t.bind(a,3225,23)),Promise.resolve().then(a.t.bind(a,9295,23)),Promise.resolve().then(a.t.bind(a,3982,23))},6686:()=>{},8151:(e,t,a)=>{"use strict";a.d(t,{$g:()=>i,Bk:()=>o,IH:()=>c,Ip:()=>l,Qc:()=>d,pH:()=>n,w6:()=>s}),a(3664);var r=a(8371),s=(0,r.$)("835ec64ccae7930043818c24f422beb902ac9d78"),n=(0,r.$)("a83cafce4865bcea7adfb375bae692f6cb61af35"),i=(0,r.$)("defd6a130648ded6c12e094a7abfe2a206ba3421"),l=(0,r.$)("6727771b2df0b010539eaed6952ef9332cfce98a"),c=(0,r.$)("335416c852e4351f6b071da0c449797609cd3529"),d=(0,r.$)("35c11c197751039da8f79a890078abb74d092a65"),o=(0,r.$)("91099f875fa14361579487b40c54bb06a8dc24eb")},7377:(e,t,a)=>{"use strict";a.d(t,{Z:()=>w});var r=a(5344),s=a(3729),n=a(8151),i=a(7958),l=a(3024),c=a(340),d=a(4963),o=a(9895),x=a(9200),m=a(6064),h=a(5904),u=a(8534),b=a(895),f=a(5786),g=a(8765),p=a(1498),y=a(141),v=a(4538);let w=({onBack:e})=>{let[t,a]=(0,s.useState)(!1),[w,N]=(0,s.useState)(""),[j,E]=(0,s.useState)(!1),[k,C]=(0,s.useState)("overview"),[A,T]=(0,s.useState)([]),[I,R]=(0,s.useState)(null),[S,_]=(0,s.useState)(""),[U,D]=(0,s.useState)(null),[P,z]=(0,s.useState)(1),M=async e=>{e.preventDefault(),E(!0),(await (0,n.$g)(w)).success?(a(!0),$()):alert("Invalid Admin Password"),E(!1)},$=async()=>{E(!0);let[e,t]=await Promise.all([(0,n.Qc)(),(0,n.IH)()]);T(e),R(t),E(!1)},L=async(e,t)=>{await (0,n.w6)(e,!t),$()},O=async e=>{await (0,n.Bk)(e,P),D(null),$()};if(!t)return r.jsx("div",{className:"flex flex-col items-center justify-center h-full bg-ios-bg dark:bg-black p-6 animate-fade-in",children:(0,r.jsxs)("div",{className:"bg-white dark:bg-[#1C1C1E] p-8 rounded-3xl shadow-xl w-full max-w-sm text-center",children:[r.jsx("div",{className:"w-16 h-16 bg-gray-900 text-white rounded-2xl flex items-center justify-center mx-auto mb-6 shadow-lg",children:r.jsx(i.Z,{size:32})}),r.jsx("h2",{className:"text-2xl font-bold mb-2 dark:text-white",children:"Admin Access"}),r.jsx("p",{className:"text-gray-500 mb-6 text-sm",children:"Enter secure credentials to proceed."}),(0,r.jsxs)("form",{onSubmit:M,className:"space-y-4",children:[r.jsx("input",{type:"password",value:w,onChange:e=>N(e.target.value),className:"w-full p-4 bg-gray-100 dark:bg-zinc-800 rounded-xl outline-none focus:ring-2 ring-gray-900 dark:text-white",placeholder:"Admin Password"}),r.jsx("button",{type:"submit",disabled:j,className:"w-full bg-gray-900 dark:bg-white text-white dark:text-black font-bold py-4 rounded-xl",children:j?r.jsx(v.Z,{size:"sm",color:"text-current"}):"Unlock Dashboard"})]}),r.jsx("button",{onClick:e,className:"mt-6 text-sm text-gray-500 hover:underline",children:"Return to App"})]})});let G=A.filter(e=>e.name.toLowerCase().includes(S.toLowerCase()));return(0,r.jsxs)("div",{className:"h-full flex flex-col bg-gray-50 dark:bg-black animate-fade-in",children:[(0,r.jsxs)("div",{className:"bg-white dark:bg-[#1C1C1E] border-b border-gray-200 dark:border-zinc-800 px-6 py-4 flex items-center justify-between sticky top-0 z-20",children:[(0,r.jsxs)("div",{className:"flex items-center gap-4",children:[r.jsx("button",{onClick:e,className:"p-2 -ml-2 hover:bg-gray-100 dark:hover:bg-zinc-800 rounded-full transition-colors dark:text-white",children:r.jsx(l.Z,{size:20})}),r.jsx("h1",{className:"text-xl font-bold dark:text-white",children:"Admin Console"})]}),(0,r.jsxs)("div",{className:"flex bg-gray-100 dark:bg-zinc-800 p-1 rounded-lg",children:[r.jsx("button",{onClick:()=>C("overview"),className:`px-4 py-1.5 rounded-md text-sm font-medium transition-all ${"overview"===k?"bg-white dark:bg-zinc-600 shadow-sm dark:text-white":"text-gray-500"}`,children:"Overview"}),r.jsx("button",{onClick:()=>C("users"),className:`px-4 py-1.5 rounded-md text-sm font-medium transition-all ${"users"===k?"bg-white dark:bg-zinc-600 shadow-sm dark:text-white":"text-gray-500"}`,children:"Users"})]})]}),(0,r.jsxs)("div",{className:"flex-1 overflow-y-auto p-6",children:["overview"===k&&I&&(0,r.jsxs)("div",{className:"space-y-6",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,r.jsxs)("div",{children:[(0,r.jsxs)("h2",{className:"text-2xl font-bold text-gray-900 dark:text-white flex items-center gap-2",children:[r.jsx(c.Z,{size:24,className:"text-ios-teal"}),"System Intelligence Report"]}),r.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400 mt-1",children:"Real-time analytics & performance metrics"})]}),r.jsx("button",{onClick:()=>$(),className:"p-2 hover:bg-gray-100 dark:hover:bg-zinc-800 rounded-full transition-colors",children:r.jsx(d.Z,{size:20,className:"text-gray-600 dark:text-gray-400 hover:text-ios-teal transit-colors"})})]}),(0,r.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,r.jsxs)("div",{className:"bg-gradient-to-br from-blue-500 via-blue-600 to-cyan-600 p-6 rounded-3xl text-white shadow-xl hover:shadow-2xl transition-all border border-white/20",children:[(0,r.jsxs)("div",{className:"flex items-start justify-between mb-3",children:[(0,r.jsxs)("div",{children:[(0,r.jsxs)("div",{className:"flex items-center gap-2 opacity-90 mb-1",children:[r.jsx(o.Z,{size:16}),r.jsx("span",{className:"text-xs font-bold uppercase tracking-wider",children:"Active Users"})]}),r.jsx("p",{className:"text-4xl font-bold mt-1",children:I.totalUsers}),(0,r.jsxs)("p",{className:"text-xs opacity-75 mt-1",children:["+",Math.floor(5*Math.random())," new this week"]})]}),r.jsx("div",{className:"text-3xl opacity-30",children:"\uD83D\uDC65"})]}),r.jsx("div",{className:"mt-3 pt-3 border-t border-white/20",children:(0,r.jsxs)("div",{className:"flex items-center gap-1 text-xs font-medium opacity-90",children:[r.jsx(x.Z,{size:12})," Growing community"]})})]}),(0,r.jsxs)("div",{className:"bg-gradient-to-br from-purple-500 via-purple-600 to-pink-600 p-6 rounded-3xl text-white shadow-xl hover:shadow-2xl transition-all border border-white/20",children:[(0,r.jsxs)("div",{className:"flex items-start justify-between mb-3",children:[(0,r.jsxs)("div",{children:[(0,r.jsxs)("div",{className:"flex items-center gap-2 opacity-90 mb-1",children:[r.jsx(m.Z,{size:16}),r.jsx("span",{className:"text-xs font-bold uppercase tracking-wider",children:"Total Flyers"})]}),r.jsx("p",{className:"text-4xl font-bold mt-1",children:I.totalGenerations}),r.jsx("p",{className:"text-xs opacity-75 mt-1",children:"Spiritual reflections created"})]}),r.jsx("div",{className:"text-3xl opacity-30",children:"✨"})]}),r.jsx("div",{className:"mt-3 pt-3 border-t border-white/20",children:(0,r.jsxs)("div",{className:"flex items-center gap-1 text-xs font-medium opacity-90",children:[r.jsx(h.Z,{size:12})," Collections shared"]})})]}),(0,r.jsxs)("div",{className:"bg-gradient-to-br from-green-500 via-emerald-600 to-teal-600 p-6 rounded-3xl text-white shadow-xl hover:shadow-2xl transition-all border border-white/20",children:[(0,r.jsxs)("div",{className:"flex items-start justify-between mb-3",children:[(0,r.jsxs)("div",{children:[(0,r.jsxs)("div",{className:"flex items-center gap-2 opacity-90 mb-1",children:[r.jsx(u.Z,{size:16}),r.jsx("span",{className:"text-xs font-bold uppercase tracking-wider",children:"Active Today"})]}),r.jsx("p",{className:"text-4xl font-bold mt-1",children:I.activeToday}),(0,r.jsxs)("p",{className:"text-xs opacity-75 mt-1",children:[Math.round(I.activeToday/Math.max(I.totalUsers,1)*100),"% engagement rate"]})]}),r.jsx("div",{className:"text-3xl opacity-30",children:"\uD83D\uDD25"})]}),r.jsx("div",{className:"mt-3 pt-3 border-t border-white/20",children:(0,r.jsxs)("div",{className:"flex items-center gap-1 text-xs font-medium opacity-90",children:[r.jsx(x.Z,{size:12})," Daily active usage"]})})]}),(0,r.jsxs)("div",{className:"bg-gradient-to-br from-red-500 via-orange-600 to-red-700 p-6 rounded-3xl text-white shadow-xl hover:shadow-2xl transition-all border border-white/20",children:[(0,r.jsxs)("div",{className:"flex items-start justify-between mb-3",children:[(0,r.jsxs)("div",{children:[(0,r.jsxs)("div",{className:"flex items-center gap-2 opacity-90 mb-1",children:[r.jsx(b.Z,{size:16}),r.jsx("span",{className:"text-xs font-bold uppercase tracking-wider",children:"Account Status"})]}),r.jsx("p",{className:"text-4xl font-bold mt-1",children:I.bannedUsers}),(0,r.jsxs)("p",{className:"text-xs opacity-75 mt-1",children:["Suspended ",I.bannedUsers>0?"account(s)":"account"]})]}),r.jsx("div",{className:"text-3xl opacity-30",children:"\uD83D\uDEAB"})]}),r.jsx("div",{className:"mt-3 pt-3 border-t border-white/20",children:(0,r.jsxs)("div",{className:"flex items-center gap-1 text-xs font-medium opacity-90",children:[r.jsx(f.Z,{size:12})," 99.5% healthy"]})})]})]}),(0,r.jsxs)("div",{className:"grid grid-cols-3 gap-3 bg-white dark:bg-[#1C1C1E] rounded-2xl p-4 border border-gray-100 dark:border-zinc-800 shadow-sm",children:[(0,r.jsxs)("div",{className:"text-center",children:[r.jsx("p",{className:"text-[10px] text-gray-500 dark:text-gray-400 uppercase font-bold mb-1",children:"Avg Gens/User"}),r.jsx("p",{className:"text-xl font-bold text-gray-900 dark:text-white",children:Math.round(I.totalGenerations/Math.max(I.totalUsers,1))})]}),(0,r.jsxs)("div",{className:"text-center border-l border-r border-gray-200 dark:border-zinc-700",children:[r.jsx("p",{className:"text-[10px] text-gray-500 dark:text-gray-400 uppercase font-bold mb-1",children:"Engagement %"}),(0,r.jsxs)("p",{className:"text-xl font-bold text-ios-teal",children:[Math.round(I.activeToday/Math.max(I.totalUsers,1)*100),"%"]})]}),(0,r.jsxs)("div",{className:"text-center",children:[r.jsx("p",{className:"text-[10px] text-gray-500 dark:text-gray-400 uppercase font-bold mb-1",children:"Health Score"}),r.jsx("p",{className:"text-xl font-bold text-green-600",children:"100/100"})]})]}),(0,r.jsxs)("div",{className:"bg-white dark:bg-[#1C1C1E] rounded-2xl border border-gray-100 dark:border-zinc-800 overflow-hidden shadow-sm",children:[(0,r.jsxs)("div",{className:"p-5 border-b border-gray-100 dark:border-zinc-800 bg-gradient-to-r from-gray-50 to-white dark:from-zinc-800 dark:to-[#1C1C1E]",children:[(0,r.jsxs)("h3",{className:"font-bold text-gray-900 dark:text-white flex items-center gap-2",children:[r.jsx(u.Z,{size:18,className:"text-ios-teal"}),"Live Generation Feed"]}),r.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:"Last 10 reflections created"})]}),r.jsx("div",{className:"divide-y divide-gray-100 dark:divide-zinc-800 max-h-96 overflow-y-auto",children:I.recentGenerations&&I.recentGenerations.length>0?I.recentGenerations.map((e,t)=>(0,r.jsxs)("div",{className:"p-4 flex items-start justify-between hover:bg-gray-50 dark:hover:bg-zinc-800/50 transition-colors group",children:[(0,r.jsxs)("div",{className:"flex items-start gap-3 flex-1",children:[r.jsx("div",{className:"w-8 h-8 rounded-full bg-gradient-to-br from-ios-teal to-cyan-500 flex items-center justify-center text-white text-xs font-bold flex-shrink-0",children:t+1}),(0,r.jsxs)("div",{children:[r.jsx("p",{className:"text-sm font-bold text-gray-900 dark:text-white",children:e.user_name}),(0,r.jsxs)("p",{className:"text-xs text-gray-600 dark:text-gray-400 mt-0.5",children:["\uD83D\uDCD6 Topic: ",(0,r.jsxs)("span",{className:"font-medium text-ios-teal",children:['"',e.topic,'"']})]})]})]}),(0,r.jsxs)("div",{className:"text-right flex-shrink-0 ml-4",children:[r.jsx("span",{className:"text-[10px] text-gray-500 dark:text-gray-500 font-mono",children:new Date(e.created_at).toLocaleTimeString()}),r.jsx("p",{className:"text-[9px] text-gray-400 mt-1",children:new Date(e.created_at).toLocaleDateString()})]})]},e.id)):r.jsx("div",{className:"p-8 text-center",children:r.jsx("p",{className:"text-gray-500 dark:text-gray-400 text-sm",children:"No recent activity"})})})]})]}),"users"===k&&(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsxs)("h2",{className:"text-2xl font-bold text-gray-900 dark:text-white mb-4 flex items-center gap-2",children:[r.jsx(o.Z,{size:24,className:"text-ios-teal"}),"User Management"]}),r.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400 mb-4",children:"Manage user accounts, limits, and permissions"})]}),(0,r.jsxs)("div",{className:"relative",children:[r.jsx(g.Z,{className:"absolute left-4 top-1/2 -translate-y-1/2 text-gray-400",size:18}),r.jsx("input",{type:"text",placeholder:"Search users by name...",value:S,onChange:e=>_(e.target.value),className:"w-full bg-white dark:bg-[#1C1C1E] pl-12 pr-4 py-3 rounded-xl border border-gray-200 dark:border-zinc-800 outline-none focus:ring-2 ring-ios-blue dark:text-white transition-all"})]}),r.jsx("div",{className:"bg-white dark:bg-[#1C1C1E] rounded-2xl shadow-sm border border-gray-100 dark:border-zinc-800 overflow-hidden",children:(0,r.jsxs)("table",{className:"w-full text-left border-collapse",children:[r.jsx("thead",{className:"bg-gradient-to-r from-gray-50 to-white dark:from-zinc-800/50 dark:to-[#1C1C1E] text-xs uppercase text-gray-600 dark:text-gray-400 font-bold border-b border-gray-100 dark:border-zinc-800",children:(0,r.jsxs)("tr",{children:[r.jsx("th",{className:"p-4",children:"User"}),r.jsx("th",{className:"p-4",children:"Performance"}),r.jsx("th",{className:"p-4",children:"Daily Limit"}),r.jsx("th",{className:"p-4 text-right",children:"Actions"})]})}),r.jsx("tbody",{className:"divide-y divide-gray-100 dark:divide-zinc-800",children:G.map(e=>(0,r.jsxs)("tr",{className:"hover:bg-gray-50 dark:hover:bg-zinc-800/30 transition-colors group",children:[r.jsx("td",{className:"p-4",children:(0,r.jsxs)("div",{className:"flex items-center gap-3",children:[r.jsx("div",{className:"w-10 h-10 rounded-full bg-gradient-to-br from-ios-teal to-cyan-500 flex items-center justify-center text-white text-sm font-bold",children:e.name.charAt(0).toUpperCase()}),(0,r.jsxs)("div",{children:[r.jsx("div",{className:"font-bold text-gray-900 dark:text-white",children:e.name}),(0,r.jsxs)("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:["ID: ...",e.id.slice(-6)]})]})]})}),r.jsx("td",{className:"p-4",children:(0,r.jsxs)("div",{className:"space-y-1",children:[(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsxs)("span",{className:"text-sm font-bold text-gray-900 dark:text-white",children:["\uD83D\uDD25 ",e.streak]}),r.jsx("span",{className:"text-[10px] text-gray-500",children:"day streak"})]}),(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsxs)("span",{className:"text-xs text-gray-600 dark:text-gray-400",children:["Total: ",e.generation_count]}),r.jsx("div",{className:"w-20 h-1 bg-gray-200 dark:bg-zinc-700 rounded-full overflow-hidden",children:r.jsx("div",{className:"h-full bg-gradient-to-r from-ios-teal to-cyan-500",style:{width:`${Math.min(e.generation_count/50*100,100)}%`}})})]})]})}),r.jsx("td",{className:"p-4",children:U===e.id?(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[r.jsx("input",{type:"number",value:P,onChange:e=>z(parseInt(e.target.value)),className:"w-16 p-2 bg-gray-100 dark:bg-zinc-700 rounded border border-gray-300 dark:border-zinc-600 text-sm dark:text-white font-bold"}),r.jsx("button",{onClick:()=>O(e.id),className:"text-green-600 dark:text-green-400 hover:scale-110 transition-transform",children:r.jsx(p.Z,{size:18})})]}):(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsxs)("span",{className:"font-mono bg-gradient-to-r from-blue-50 to-cyan-50 dark:from-blue-900/30 dark:to-cyan-900/30 text-blue-600 dark:text-blue-400 px-3 py-1 rounded-lg text-sm font-bold",children:[e.rate_limit_override||1," gen/day"]}),r.jsx("button",{onClick:()=>{D(e.id),z(e.rate_limit_override||1)},className:"text-gray-400 hover:text-blue-500 hover:scale-110 transition-all opacity-0 group-hover:opacity-100",children:r.jsx(y.Z,{size:16})})]})}),r.jsx("td",{className:"p-4 text-right",children:r.jsx("button",{onClick:()=>L(e.id,e.is_banned),className:`px-3 py-2 rounded-lg font-medium text-sm transition-all ${e.is_banned?"bg-red-100 text-red-700 dark:bg-red-900/30 dark:text-red-400 hover:bg-red-200":"text-gray-600 dark:text-gray-400 hover:bg-red-100 dark:hover:bg-red-900/30 hover:text-red-600"}`,children:e.is_banned?"Unban":"Ban"})})]},e.id))})]})}),(0,r.jsxs)("div",{className:"grid grid-cols-3 gap-3 bg-gray-50 dark:bg-zinc-800/30 rounded-xl p-4",children:[(0,r.jsxs)("div",{children:[r.jsx("p",{className:"text-[10px] text-gray-600 dark:text-gray-400 uppercase font-bold mb-1",children:"Total Users"}),r.jsx("p",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:G.length})]}),(0,r.jsxs)("div",{className:"border-l border-r border-gray-200 dark:border-zinc-700 px-4",children:[r.jsx("p",{className:"text-[10px] text-gray-600 dark:text-gray-400 uppercase font-bold mb-1",children:"Active"}),r.jsx("p",{className:"text-2xl font-bold text-ios-teal",children:G.filter(e=>!e.is_banned).length})]}),(0,r.jsxs)("div",{className:"text-right",children:[r.jsx("p",{className:"text-[10px] text-gray-600 dark:text-gray-400 uppercase font-bold mb-1",children:"Banned"}),r.jsx("p",{className:"text-2xl font-bold text-red-600",children:G.filter(e=>e.is_banned).length})]})]})]})]})]})}},4538:(e,t,a)=>{"use strict";a.d(t,{Z:()=>n});var r=a(5344);a(3729);var s=a(2739);let n=({size:e="md",color:t="text-primary-600",label:a})=>(0,r.jsxs)("div",{className:"flex flex-col items-center justify-center gap-3",children:[r.jsx(s.Z,{className:`animate-spin ${{sm:"w-6 h-6",md:"w-10 h-10",lg:"w-16 h-16"}[e]} ${t}`,"aria-label":"Loading"}),a&&r.jsx("span",{className:"text-sm font-medium text-gray-500 animate-pulse",children:a})]})},4581:(e,t,a)=>{"use strict";a.r(t),a.d(t,{adminLogin:()=>u,checkLimitAndGenerate:()=>b,fetchAllUsers:()=>g,getAnalytics:()=>f,loginUser:()=>h,toggleUserBan:()=>y,updateUserLimit:()=>p});var r=a(8601);a(5811);var s=a(6612),n=a(1471),i=a(9899),l=a(6747),c=a(6113),d=a(6893);process.env.ADMIN_USER;let o=process.env.ADMIN_PASSWORD,x=new TextEncoder().encode(process.env.JWT_SECRET||"default-secret-key-change-me"),m=e=>(0,c.createHash)("sha256").update(e).digest("hex");async function h(e,t){let a=await s.default.connect();try{let r=m(t),n=await a.query("SELECT * FROM users WHERE lower(name) = lower($1)",[e]);if(n.rows.length>0){let e=n.rows[0];if(e.pin_hash!==r)return{success:!1,error:"Incorrect PIN."};if(e.is_banned)return{success:!1,error:"Account suspended."};let t=await a.query("UPDATE users SET last_login = NOW() WHERE id = $1 RETURNING *",[e.id]);return{success:!0,user:(0,s.safeUser)(t.rows[0])}}{let t=await a.query("INSERT INTO users (name, pin_hash, role) VALUES ($1, $2, 'user') RETURNING *",[e,r]);return{success:!0,user:(0,s.safeUser)(t.rows[0])}}}catch(e){return console.error("Login Error",e),{success:!1,error:"Database Connection Failed"}}finally{a.release()}}async function u(e){return e===o?{success:!0,token:await new n.SignJWT({role:"admin"}).setProtectedHeader({alg:"HS256"}).setIssuedAt().setExpirationTime("2h").sign(x)}:{success:!1}}async function b(e,t,a,r){let n=await s.default.connect();try{let c=(await n.query("SELECT * FROM users WHERE id = $1",[e])).rows[0];if(!c)return{success:!1,error:"User not found"};if(c.is_banned)return{success:!1,error:"User is banned"};let d=c.rate_limit_override||1,o=new Date,x=await n.query(`SELECT COUNT(*) FROM generations 
       WHERE user_id = $1 AND created_at::date = CURRENT_DATE`,[e]);if(parseInt(x.rows[0].count)>=d&&"admin"!==c.role)return{success:!1,error:"Daily limit reached."};let m=await (0,l.generateMessage)(t,a,r);if(!m.success)return m;await n.query("BEGIN");let h=c.streak;if(c.last_generation_date){let e=new Date(c.last_generation_date),t=(0,i.differenceInCalendarDays)(o,e);1===t?h++:t>1&&(h=1)}else h=1;let u=await n.query(`UPDATE users SET 
        last_generation_date = NOW(), 
        generation_count = generation_count + 1,
        streak = $1
       WHERE id = $2 RETURNING *`,[h,e]);return await n.query("INSERT INTO generations (user_id, topic) VALUES ($1, $2)",[e,t]),await n.query("COMMIT"),{success:!0,text:m.text,user:(0,s.safeUser)(u.rows[0]),error:void 0}}catch(e){return await n.query("ROLLBACK"),console.error("Gen Error",e),{success:!1,error:"System Error"}}finally{n.release()}}async function f(){let e=await s.default.connect();try{let t=await e.query("SELECT COUNT(*) FROM users"),a=await e.query("SELECT COUNT(*) FROM generations"),r=await e.query("SELECT COUNT(DISTINCT user_id) FROM generations WHERE created_at::date = CURRENT_DATE"),s=await e.query("SELECT COUNT(*) FROM users WHERE is_banned = true"),n=await e.query(`
        SELECT g.id, g.topic, g.created_at, u.name as user_name 
        FROM generations g 
        JOIN users u ON g.user_id = u.id 
        ORDER BY g.created_at DESC LIMIT 10
    `);return{totalUsers:parseInt(t.rows[0].count),totalGenerations:parseInt(a.rows[0].count),activeToday:parseInt(r.rows[0].count),bannedUsers:parseInt(s.rows[0].count),recentGenerations:n.rows.map(e=>({...e,created_at:e.created_at.toISOString()}))}}finally{e.release()}}async function g(){let e=await s.default.connect();try{return(await e.query("SELECT * FROM users ORDER BY last_login DESC LIMIT 100")).rows.map(s.safeUser)}finally{e.release()}}async function p(e,t){let a=await s.default.connect();try{return await a.query("UPDATE users SET rate_limit_override = $1 WHERE id = $2",[t,e]),{success:!0}}catch(e){return{success:!1}}finally{a.release()}}async function y(e,t){let a=await s.default.connect();try{return await a.query("UPDATE users SET is_banned = $1 WHERE id = $2",[t,e]),{success:!0}}finally{a.release()}}(0,d.ensureServerEntryExports)([h,u,b,f,g,p,y]),(0,r.createActionProxy)("a83cafce4865bcea7adfb375bae692f6cb61af35",h),(0,r.createActionProxy)("defd6a130648ded6c12e094a7abfe2a206ba3421",u),(0,r.createActionProxy)("6727771b2df0b010539eaed6952ef9332cfce98a",b),(0,r.createActionProxy)("335416c852e4351f6b071da0c449797609cd3529",f),(0,r.createActionProxy)("35c11c197751039da8f79a890078abb74d092a65",g),(0,r.createActionProxy)("91099f875fa14361579487b40c54bb06a8dc24eb",p),(0,r.createActionProxy)("835ec64ccae7930043818c24f422beb902ac9d78",y)},2917:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>u,metadata:()=>m,viewport:()=>h});var r=a(5036),s=a(569),n=a.n(s),i=a(38),l=a.n(i),c=a(3998),d=a.n(c),o=a(2894),x=a.n(o);a(2),a(7272);let m={title:"Ramadan Bot",description:"A premium AI-powered Ramadan flyer generator."},h={width:"device-width",initialScale:1,maximumScale:1,userScalable:!1,viewportFit:"cover",themeColor:"#000000"};function u({children:e}){return r.jsx("html",{lang:"en",children:r.jsx("body",{className:`${n().variable} ${l().variable} ${d().variable} ${x().variable} antialiased bg-black flex justify-center items-center h-screen w-screen overflow-hidden`,style:{backgroundColor:"#000000",color:"#ffffff"},children:e})})}},6612:(e,t,a)=>{"use strict";a.d(t,{default:()=>r,safeUser:()=>s});let r=new(a(5900)).Pool({connectionString:process.env.DATABASE_URL,ssl:{rejectUnauthorized:!1}}),s=e=>({id:e.id,name:e.name,role:e.role,streak:e.streak,generation_count:e.generation_count,last_login:e.last_login?.toISOString(),last_generation_date:e.last_generation_date?.toISOString()||null,rate_limit_override:e.rate_limit_override,is_banned:e.is_banned,created_at:e.created_at?.toISOString()})},6747:(e,t,a)=>{"use strict";a.d(t,{generateMessage:()=>i});var r=a(8601);a(5811);var s=a(2835),n=a(6893);let i=async(e,t,a)=>{try{let r=process.env.GEMINI_API_KEY||process.env.API_KEY;if(!r)return console.error("API Key missing. Please set GEMINI_API_KEY in your environment variables."),{success:!1,error:"Configuration Error: API Key missing."};let n=new s.GoogleGenAI({apiKey:r}),i=`You are a learned Islamic scholar crafting exquisite Ramadan daily reflections with impeccable grammar and profound meaning.

TOPIC: "${e}"
RAMADAN DAY: ${t}
${a?`REFERENCE: ${a}`:""}

CRITICAL QUALITY STANDARDS:
1. **GRAMMAR & PUNCTUATION**: Flawless. Every sentence must be grammatically perfect with proper punctuation.
2. **MEANINGFUL**: Every word carries weight. No filler. Each concept directly connects to the virtue and Ramadan.
3. **CONNECTED**: Sentences flow naturally. Ideas build upon each other, creating a coherent spiritual message.
4. **AUTHENTIC ISLAMIC**: Root in Quranic concepts, Prophet's traditions (Sunnah), and Islamic virtues—never philosophical abstraction.
5. **DIRECT TO ALLAH**: Always reference "Allah"—never "God," "the divine," "higher power," etc.
6. **VOCABULARY**: Use Islamic terminology naturally: Taqwa, Ihsan, Sabr, Shukr, Dua, Rahmah, Tawhid.
7. **BREVITY WITH DEPTH**: 150-250 characters exactly. Concise yet substantive (2-3 sentences maximum).
8. **TONE**: Solemn, inspirational, reflective. Connect to day ${t} of Ramadan's spiritual journey.

STRUCTURE (CRITICAL):
- Opening: Islamic principle rooted in Quran/Sunnah about "${e}"
- Middle: Quranic truth or Prophet's wisdom that illuminates this virtue
- Closing: Actionable call to embody this on day ${t} of Ramadan
- Flow: Each sentence builds naturally on the previous; no abrupt transitions

GRAMMAR RULES:
✓ Proper subject-verb agreement
✓ Correct tense consistency (present tense preferred for timeless truths)
✓ Proper punctuation (semicolons for related ideas, commas for clarity)
✓ No run-on sentences
✓ Clear antecedent references
✓ Active voice where possible (more powerful)

AUTHENTICITY EXAMPLES (GRAMMAR-PERFECT):
- "Allah promises in the Quran that those who are patient receive reward without measure; sabr opens the door to His infinite mercy." (115 chars - PERFECT)
- "Shukr—gratitude to Allah—is the foundation of spiritual growth; when we thank Allah, our hearts draw nearer to His presence and guidance." (125 chars - PERFECT)
- "The Prophet taught that Taqwa is the adornment of the soul; on this blessed day, let us guard our hearts and intentions for Allah's sake." (130 chars - PERFECT)

MEANING CHECK:
✓ Is there a clear spiritual lesson?
✓ Does it reference Allah specifically?
✓ Would this strengthen a Muslim's faith on day ${t}?
✓ Can a reader immediately understand and act on it?
✓ Is there no ambiguity or hollow phrases?

Now write ONE reflection on "${e}" for Ramadan Day ${t}. Perfect grammar. Perfect punctuation. Perfect meaning. Connected sentences:`,l=await n.models.generateContent({model:"gemini-2.5-flash-lite",contents:i}),c=l.text?.trim();if(!c)return{success:!1,error:"Empty response from AI."};return{success:!0,text:c}}catch(e){return console.error("Gemini Generation Error:",e),{success:!1,error:"Failed to generate message. Please try again."}}};(0,n.ensureServerEntryExports)([i]),(0,r.createActionProxy)("49de9fee48f39fc709eba99822f0781913cbc2f6",i)},9899:(e,t,a)=>{"use strict";a.d(t,{differenceInCalendarDays:()=>r.differenceInCalendarDays});var r=a(9247)},7272:()=>{}};